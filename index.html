<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>Send files safely, encryption done in browser.</title>
	<style type="text/css">
		@import url(./assets/font.css);
	</style>
	<link href="/assets/main.css" rel="stylesheet" type="text/css" />
</head>

<body>

	<span id="forkongithub"><a href="https://github.com/santrancisco/relaysecret">Fork me on GitHub</a></span>
	<div name="pageheader" class=container>
		<div class="divTablefullwidth">
			<div class="divTableBody">
				<div class="divTableRow">
					<div class="divTableCell" style="float: left;">
						<h1 class="header__title">Relay Secret</h1>
					</div>
					<div class="divTableCell" style="float: right;">
						<h1>
							<button id="btnDivEncMes" onClick="javascript:switchdiv('encryptmessage');">
								Encrypt a Message
							</button>
							<button id="btnDivEncrypt" onClick="javascript:switchdiv('encryptfile');">
								Encrypt a File</button>
							<button id="btnDivDecrypt" onClick="javascript:switchdiv('decrypt');">
								Decrypt a File</button>
							<button id="btnRefresh" onClick="javascript:location.reload();">
								Refresh Page
							</button>
							
						</h1>
					</div>
				</div>
			</div>
		</div>
	</div>


	<div name="thematicbreak" class=container>
		<hr>
	</div>

	<div class="container" id=divEncrypt style="display:none">
		<div id=divEncryptMessage>
			<h2>Encrypt a message</h2>
			<div>
				<textarea placeholder="please enter your secret message here..." id="textareaEncryptmessage" name="secret" maxlength="500"></textarea>
			</div>
		</div>
		<div id=divEncryptFile>
			<h2>Encrypt a File</h2>
			<p>To encrypt and send a file, drop the file (Max 30Mb)</p>
			<p><u>Note: Filename is not encrypted!</u></p>


			<div>
				<div class=dropzone id="encdropzone" ondrop="drop_handler(event);" ondragover="dragover_handler(event);"
					ondragend="dragend_handler(event);">
					<p>Drag and drop the file to be encrypted into this dropzone, or click <a
							onclick=javascript:encfileElem.click();>here</a> to select file.</p>
					<p><b><span id=spnencfilename></span></b></p>
				</div>
				<input type="file" id="encfileElem" style="display:none" onchange="selectfile(this.files)">
			</div>
		</div>
		<p></p>
		<div class="divTable">
			<div class="divTableBody">
				<div class="divTableRow" id=divFilename>
					<div class="divTableCell">Filename</div>
					<div class="divTableCell"><input id=txtFilename onchange="originalfilename=txtFilename.value" size=30 value=''></div>
					<div class="divTableCell" style="color:#FF851d">(This is stored in cleartext - change if sensitive)
					</div>
				</div>
				<div class="divTableRow">
					<div class="divTableCell">Password</div>
					<div class="divTableCell"><input id=txtEncpassphrase size=30 value=''></div>
					<div class="divTableCell">(For extra security but file will be encrypted regardless)</div>
				</div>
				<div class="divTableRow">
					<div class="divTableCell">Expire in: </div>
					<div class="divTableCell">
						<select name="expiretime" id="expiretime">
							<option value="1">1 day</option>
							<option value="2">2 days</option>
							<option value="3">3 days</option>
							<option value="4">4 days</option>
							<option value="5">5 days</option>
						</select>
					</div>

				</div>
			</div>
		</div>

		<p> </p>
		<p> </p>

		<div class="divTable">
			<div class="divTableBody">
				<div class="divTableRow">
					<div class="divTableCell"><button id=btnEncrypt onclick=javascript:encryptfile();>Encrypt
							File</button></div>
					<input type="checkbox" id="inputdeleteondownload" name="inputdeleteondownload" value="false">
					<label for="inputdeleteondownload"> Delete On Download</label><br>

				</div>
				<div class="divTableRow">
					<div class="divTableCell"><span id=spnEncstatus></span></div>
				</div>

			</div>
		</div>
		<p> </p>
		<div class="divTable">
			<div class="divTableBody">

			</div>
		</div>

		<p> </p>
	</div>

	<div class="container" id=divEncryptResult style="display:none">
		<div class="divTableBody">
			<div class="divTableRow">
				<p><b>Download URL:<span id=spandownloadurl></span></b></p>
			</div>
			<div class="divTableRow"></div>
			<div class="divTableRow">
				<p style="color: #0074D9;">Encrypted obj key : <span id="span_objname"></span></p>
				<p style="color: #FF851B;">Key material : <span id="span_keymat"></span></p>
			</div>
			<div class="divTableRow">
				<p style="color: #303030;">
					<b>Note: </b> Notice that the key material is behind anchortag (#) and never
					leave your browser. You can find more information in <a
						href="https://en.wikipedia.org/wiki/URI_fragment">wikipedia (URI fragment)</a> and on official
					<a href="https://tools.ietf.org/html/rfc1808#section-2.4.1">RFC1808</a></b>
				</p>
			</div>
		</div>
	</div>

	<div class="container" id=divDecrypt style="display:none">
		<h2>Decrypt a File</h2>
		<p>Filesize: <b id="filesize">pending...</b></p>

		<div class="divTable">
			<div class="divTableBody">
				<div class="divTableRow">
					<div class="divTableCell">Password</div>
					<div class="divTableCell"><input id=txtDecpassphrase size=30 value=''></div>
					<div class="divTableCell">(Optional, anchorkey is always used regardless)</div>
				</div>
			</div>
		</div>
		
		<p> </p>
		<div>
			<button id=btnDecrypt onclick=javascript:decryptfile();>Download & Decrypt File</button> 
			<span id="spnDecstatus"></span>
			<br>
			<div id=divDecryptmessage style="display:none">
				<h3>Decrypted message</h3>
				<div>
					<textarea id="textareaDecryptmessage" maxlength="500"></textarea>
				</div>
			</div>
			<br>
			<a id=aDecsavefile onclick="javascript:postdownloadaction();" hidden><button>Save Encrypted
					File</button></a>
		</div>

		<p> </p>
		<div>
			<a id=aDeleteFile hidden><button onclick=javascript:deletefile();>Delete File</button></a>
		</div>
	</div>

	</div>
	<BR>
	<div class="modal">
		<div class="modal-grid">
			<div id="modalstatus" class="modal-grid-item">
				<h1>Please wait ...</h1>
			</div>
		</div>
	</div>
</body>

</html>

<script src="/assets/config.js"></script>
<script src="/assets/main.js">


</script>